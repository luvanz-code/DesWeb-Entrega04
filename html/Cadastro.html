<!DOCTYPE html>

<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro - Ong Água Limpa para Todos</title>
    <link rel="shortcut icon" href="../Imagens/gota.ico" type="image/x-icon">
    <meta name="description"
        content="Página de cadastro para voluntários da Ong Água Limpa para Todos. Preencha o formulário e junte-se a nós.">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: "Lucida Bright", serif;
        }
        /* Estilos para feedback de validação */
        input:invalid:not(:placeholder-shown) {
            border-color: #ef4444; /* vermelho-500 */
        }
        input:valid:not(:placeholder-shown) {
            border-color: #22c55e; /* verde-500 */
        }
        /* Classe de erro para as mensagens */
        .input-error {
            display: none;
            color: #ef4444; /* vermelho-500 */
            font-size: 0.875rem; /* text-sm */
            margin-top: 0.25rem;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <header class="bg-white shadow-md">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <h1 class="text-2xl font-bold text-blue-600">
                    <a href="index.html">💧 Água Limpa para Todos</a>
                </h1>
                <nav>
                    <ul class="flex space-x-6 text-lg">
                        <li><a href="index.html" class="text-gray-600 hover:text-blue-600 transition">Início</a></li>
                        <li><a href="projetos.html" class="text-gray-600 hover:text-blue-600 transition">Projetos</a>
                        </li>
                        <li><a href="cadastro.html"
                                class="text-blue-600 font-semibold border-b-2 border-blue-600">Participe</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>
    <main class="py-16 px-6">
        <section class="container mx-auto max-w-2xl">
            <div class="bg-white p-8 md:p-12 rounded-lg shadow-xl">
                <div class="text-center mb-8">
                    <img src="../Imagens/voluntario.png"
                        alt="Ícone de duas mãos se unindo, simbolizando parceria e voluntariado."
                        class="mx-auto rounded-full mb-4">
                    <h2 class="text-3xl font-bold">Formulário de Voluntariado</h2>
                    <p class="text-gray-600 mt-2">Preencha seus dados para se tornar um agente de mudança!</p>
                </div>
                <form id="cadastroForm" action="#" method="POST" novalidate>
                    <fieldset class="border border-gray-300 rounded-lg p-6 mb-6">
                        <legend class="text-lg font-semibold px-2 text-gray-700">Dados Pessoais</legend>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="md:col-span-2">
                                <label for="nome" class="block text-sm font-medium text-gray-700 mb-1">Nome
                                    Completo</label>
                                <input type="text" id="nome" name="nome" placeholder="Seu nome completo" required
                                    minlength="5"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition">
                                <span id="nome-erro" class="input-error"></span>
                            </div>
                            <div>
                                <label for="email" class="block text-sm font-medium text-gray-700 mb-1">E-mail</label>
                                <input type="email" id="email" name="email" placeholder="seu@email.com" required
                                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition">
                                <span id="email-erro" class="input-error"></span>
                            </div>
                            <div>
                                <label for="nascimento" class="block text-sm font-medium text-gray-700 mb-1">Data de
                                    Nascimento</label>
                                <input type="date" id="nascimento" name="nascimento" required
                                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition">
                                <span id="nascimento-erro" class="input-error"></span>
                            </div>
                            <div>
                                <label for="cpf" class="block text-sm font-medium text-gray-700 mb-1">CPF</label>
                                <input type="text" id="cpf" name="cpf" placeholder="000.000.000-00" required
                                    pattern="\d{3}\.\d{3}\.\d{3}-\d{2}"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition">
                                <span id="cpf-erro" class="input-error"></span>
                            </div>
                            <div>
                                <label for="telefone"
                                    class="block text-sm font-medium text-gray-700 mb-1">Telefone</label>
                                <input type="tel" id="telefone" name="telefone" placeholder="(00) 00000-0000" required
                                    pattern="\(\d{2}\) \d{5}-\d{4}"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition">
                                <span id="telefone-erro" class="input-error"></span>
                            </div>
                        </div>
                    </fieldset>
                    <fieldset class="border border-gray-300 rounded-lg p-6 mb-8">
                        <legend class="text-lg font-semibold px-2 text-gray-700">Endereço</legend>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                            <div class="md:col-span-1">
                                <label for="cep" class="block text-sm font-medium text-gray-700 mb-1">CEP</label>
                                <input type="text" id="cep" name="cep" placeholder="00000-000" required
                                    pattern="\d{5}-\d{3}"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition">
                                <span id="cep-erro" class="input-error"></span>
                            </div>
                            <div class="md:col-span-3">
                                <label for="endereco"
                                    class="block text-sm font-medium text-gray-700 mb-1">Endereço</label>
                                <input type="text" id="endereco" name="endereco" placeholder="Rua, Avenida, etc."
                                    required
                                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition">
                                <span id="endereco-erro" class="input-error"></span>
                            </div>
                            <div class="md:col-span-2">
                                <label for="cidade" class="block text-sm font-medium text-gray-700 mb-1">Cidade</label>
                                <input type="text" id="cidade" name="cidade" required
                                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition">
                                <span id="cidade-erro" class="input-error"></span>
                            </div>
                            <div class="md:col-span-2">
                                <label for="estado" class="block text-sm font-medium text-gray-700 mb-1">Estado</label>
                                <input type="text" id="estado" name="estado" required
                                    class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition">
                                <span id="estado-erro" class="input-error"></span>
                            </div>
                        </div>
                    </fieldset>
                    <button type="submit"
                        class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-md text-lg hover:bg-blue-700 transition focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        Enviar Cadastro
                    </button>
                </form>
            </div>
        </section>
    </main>
    <footer class="bg-gray-800 text-white py-10 px-6 mt-16">
        <div class="container mx-auto text-center">
            <h3 class="text-xl font-bold mb-2">ONG Água Limpa para Todos</h3>
            <p class="mb-4">Dignidade que flui, gota a gota.</p>
            <address class="not-italic">
                <p><strong>Contato:</strong></p>
                <p>Email: <a href="mailto:contato@aguaparatodos.org"
                        class="text-blue-400 hover:underline">contato@aguaparatodos.org</a></p>
                <p>Telefone: <a href="tel:+5511999998888" class="text-blue-400 hover:underline">(41) 9 8765-4321</a></p>
                <p>Rua da Água Potável, 123, Curitiba - PR</p>
            </address>
            <p class="mt-6 text-sm text-gray-400">&copy; 2025 Ong Água Limpa para Todos. Todos os direitos reservados.
            </p>
        </div>
    </footer>
    <script>
        // Função utilitária para exibir ou esconder mensagens de erro
        function exibirFeedback(input, mensagem) {
            const errorElement = document.getElementById(input.id + '-erro');

            // 1. Manipulação do DOM: Define a mensagem de erro
            errorElement.textContent = mensagem;

            // 2. Manipulação do DOM: Mostra ou esconde o span de erro
            if (mensagem) {
                errorElement.style.display = 'block'; // Mostra a mensagem
            } else {
                errorElement.style.display = 'none'; // Esconde a mensagem
            }
        }

        // Validações de Consistência Específicas
        function validarNome(input) {
            // Verifica se o campo Nome contém apenas letras e espaços
            const regexNome = /^[a-zA-ZÀ-ÿ\s]+$/;
            
            if (input.value.length < 5 && input.value.length > 0) {
                const mensagem = "O nome deve ter pelo menos 5 caracteres.";
                input.setCustomValidity(mensagem);
                exibirFeedback(input, mensagem);
            } else if (input.value && !regexNome.test(input.value)) {
                const mensagem = "O nome deve conter apenas letras e espaços.";
                input.setCustomValidity(mensagem);
                exibirFeedback(input, mensagem);
            } else {
                input.setCustomValidity(""); // Campo válido, remove a mensagem de erro
                exibirFeedback(input, "");
            }
        }

        function validarIdade(input) {
            const dataNascimento = new Date(input.value);
            const hoje = new Date();
            const idade = hoje.getFullYear() - dataNascimento.getFullYear();
            const maioridade = 18;

            // Verificação de Consistência: Ser maior de 18 anos
            if (input.value && idade < maioridade) {
                const mensagem = `Você deve ter no mínimo ${maioridade} anos para se voluntariar.`;
                input.setCustomValidity(mensagem);
                exibirFeedback(input, mensagem);
            } else {
                input.setCustomValidity(""); // Campo válido
                exibirFeedback(input, "");
            }
        }

        // Função de Validação Principal
        function setupFormValidation() {
            const form = document.getElementById('cadastroForm');
            const nomeInput = form.querySelector('#nome');
            const nascimentoInput = form.querySelector('#nascimento');
            
            // Adiciona ouvintes para validação em tempo real (on input/blur)
            nomeInput.addEventListener('input', () => validarNome(nomeInput));
            nascimentoInput.addEventListener('change', () => validarIdade(nascimentoInput));
            
            // 1. Intercepta o envio do formulário
            form.addEventListener('submit', (event) => {
                // Revalida todas as regras de consistência antes do envio
                validarNome(nomeInput);
                validarIdade(nascimentoInput);
                
                // 2. Verifica a validade do formulário (incluindo as regras customizadas)
                if (!form.checkValidity()) {
                    event.preventDefault(); // Impede o envio se houver erros
                    // Se o formulário for inválido, o próprio navegador exibe a mensagem de erro
                    // No entanto, para fins de aviso, você pode adicionar um alerta:
                    alert("Atenção! Por favor, corrija os campos destacados em vermelho.");
                    
                    // Foca no primeiro campo inválido
                    form.querySelector(':invalid:not(fieldset)').focus();
                } else {
                    event.preventDefault(); // Impede o envio (para simular a submissão)
                    alert("✅ Cadastro enviado com sucesso! Agradecemos seu interesse em ser voluntário.");
                    form.reset();
                    // Opcional: Aqui você faria o fetch() para enviar os dados para o servidor
                }
            });

            // Adiciona ouvintes para exibir o feedback de validação HTML5 nativo
            form.querySelectorAll('input').forEach(input => {
                input.addEventListener('invalid', (e) => {
                    // Impede o pop-up padrão do navegador e deixa o CSS customizado e a manipulação do DOM agirem
                    e.preventDefault(); 
                    
                    // Garante que o feedback seja exibido para campos HTML5 inválidos
                    if (input.validity.valueMissing) {
                         exibirFeedback(input, "Este campo é obrigatório.");
                    } else if (input.validity.typeMismatch) {
                         exibirFeedback(input, "Por favor, insira um valor válido para este tipo de campo.");
                    } else if (input.validity.patternMismatch) {
                        exibirFeedback(input, "O formato preenchido está incorreto.");
                    } else {
                        // Se o erro não for customizado ou não cair nas regras acima, limpa a mensagem
                        exibirFeedback(input, "");
                    }
                });
                
                input.addEventListener('input', () => {
                    // Remove mensagens de erro ao digitar, se o campo for válido
                    if (input.validity.valid) {
                         exibirFeedback(input, "");
                    }
                });
            });
        }


        // --- Funções de Máscara de Input (Mantidas) ---
        const applyMask = (element, maskFunction) => {
            element.addEventListener('input', (e) => {
                e.target.value = maskFunction(e.target.value);
            });
        };
        const cpfMask = (value) => {
            return value
                .replace(/\D/g, '')
                .replace(/(\d{3})(\d)/, '$1.$2')
                .replace(/(\d{3})(\d)/, '$1.$2')
                .replace(/(\d{3})(\d{1,2})/, '$1-$2')
                .substring(0, 14);
        };
        const phoneMask = (value) => {
            return value
                .replace(/\D/g, '')
                .replace(/^(\d{2})(\d)/g, '($1) $2')
                .replace(/(\d{5})(\d)/, '$1-$2')
                .substring(0, 15);
        };
        const cepMask = (value) => {
            return value
                .replace(/\D/g, '')
                .replace(/(\d{5})(\d)/, '$1-$2')
                .substring(0, 9);
        };
        // API ViaCEP
        const cepInputHandler = async (e) => {
            const cep = e.target.value.replace(/\D/g, '');
            if (cep.length === 8) {
                try {
                    // Utiliza a API ViaCEP
                    const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
                    if (!response.ok) throw new Error('CEP não encontrado');
                    const data = await response.json();
                    
                    const enderecoInput = document.getElementById('endereco');
                    const cidadeInput = document.getElementById('cidade');
                    const estadoInput = document.getElementById('estado');

                    if (data.erro) {
                        exibirFeedback(document.getElementById('cep'), 'CEP não localizado.');
                        enderecoInput.value = cidadeInput.value = estadoInput.value = '';
                    } else {
                        exibirFeedback(document.getElementById('cep'), '');
                        enderecoInput.value = data.logradouro;
                        cidadeInput.value = data.localidade;
                        estadoInput.value = data.uf;
                    }
                } catch (error) {
                    exibirFeedback(document.getElementById('cep'), 'Erro ao buscar CEP. Tente novamente.');
                }
            }
        };


        // --- Inicialização de Todos os Scripts ---
        document.addEventListener('DOMContentLoaded', () => {
            // 1. Aplica máscaras
            applyMask(document.getElementById('cpf'), cpfMask);
            applyMask(document.getElementById('telefone'), phoneMask);
            applyMask(document.getElementById('cep'), cepMask);

            // 2. Adiciona o ouvinte para a busca de CEP (no blur)
            document.getElementById('cep').addEventListener('blur', cepInputHandler);
            
            // 3. Configura a validação principal do formulário
            setupFormValidation();
        });
    </script>
</body>
</html>